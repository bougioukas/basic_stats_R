[
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Basic Medical Statistics with R",
    "section": "License",
    "text": "License\nThis textbook is free to use, and is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 4.0 License."
  },
  {
    "objectID": "two_samples.html",
    "href": "two_samples.html",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "",
    "text": "When we have finished this Chapter, we should be able to:\nTwo sample t-test (Student’s t-test) can be used if we have two independent (unrelated) groups (e.g., males-females, treatment-non treatment) and one quantitative variable of interest."
  },
  {
    "objectID": "two_samples.html#research-question",
    "href": "two_samples.html#research-question",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.1 Research question",
    "text": "1.1 Research question\nIn an experiment designed to test the effectiveness of paroxetine for treating bipolar depression, the participants were randomly assigned into two groups (paroxetine Vs placebo). The researchers used the Hamilton Depression Rating Scale (HDRS) to measure the depression state of the participants and wanted to find out if the HDRS score is different in paroxetine group as compared to placebo group at the end of the experiment. The significance level \\(\\alpha\\) was set to 0.05.\nNote: A score of 0–7 in HDRS is generally accepted to be within the normal range, while a score of 20 or higher indicates at least moderate severity."
  },
  {
    "objectID": "two_samples.html#hypothesis-testsing",
    "href": "two_samples.html#hypothesis-testsing",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.2 Hypothesis Testsing",
    "text": "1.2 Hypothesis Testsing\n\n\n\n\n\n\nNull hypothesis and alternative hypothesis\n\n\n\n\n\n\\(H_0\\): the means of HDRS in the two groups are equal (\\(\\mu_{1} = \\mu_{2}\\))\n\n\\(H_1\\): the means of HDRS in the two groups are not equal (\\(\\mu_{1} \\neq \\mu_{2}\\))"
  },
  {
    "objectID": "two_samples.html#preraring-the-data",
    "href": "two_samples.html#preraring-the-data",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.3 Preraring the data",
    "text": "1.3 Preraring the data\nWe import the data in R:\n\nlibrary(readxl)\ndepression <- read_excel(here(\"data\", \"depression.xlsx\"))\n\n\n\n\nFigure 1.1: Table with data from “depression” file.\n\n\n\nWe inspect the data and the type of variables:\n\nglimpse(depression)\n\nRows: 76\nColumns: 2\n$ intervention <chr> \"placebo\", \"placebo\", \"placebo\", \"placebo\", \"placebo\", \"p…\n$ HDRS         <dbl> 19, 21, 28, 22, 22, 28, 23, 17, 19, 20, 26, 23, 23, 22, 1…\n\n\nThe data set depression has 76 patients (rows) and includes two variables (columns). The numeric (<dbl>) HDRS variable and the character (<chr>) intervention variable which should be converted to a factor (<fct>) variable using the factor() function as follows:\n\ndepression <- depression %>% \n  mutate(intervention = factor(intervention))\nglimpse(depression)\n\nRows: 76\nColumns: 2\n$ intervention <fct> placebo, placebo, placebo, placebo, placebo, placebo, pla…\n$ HDRS         <dbl> 19, 21, 28, 22, 22, 28, 23, 17, 19, 20, 26, 23, 23, 22, 1…"
  },
  {
    "objectID": "two_samples.html#assumptions",
    "href": "two_samples.html#assumptions",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.4 Assumptions",
    "text": "1.4 Assumptions\n\n\n\n\n\n\nCheck if the following assumptions are satisfied\n\n\n\n\nThe data are normally distributed in both groups\nThe data in both groups have similar variance (also named as homogeneity of variance or homoscedasticity)\n\n\n\nA. Explore the descriptive characteristics of distribution for each group and check for normality\nThe distributions can be explored visually with appropriate plots. Additionally, summary statistics and significance tests to check for normality (e.g., Shapiro-Wilk test) can be used.\nWe can visualize the distribution of HDRS for the two groups:\n\nggplot(depression, aes(x=intervention, y=HDRS)) + \n  geom_flat_violin(aes(fill = intervention), scale = \"count\") +\n  geom_boxplot(width = 0.14, outlier.shape = NA, alpha = 0.5) +\n  geom_point(position = position_jitter(width = 0.05), \n             size = 1.2, alpha = 0.6) +\n  scale_fill_brewer(palette = \"Spectral\") +\n  theme_classic(base_size = 14) +\n  theme(legend.position=\"none\",\n        axis.text = element_text(size = 14))\n\n\n\nFigure 1.2: Rain cloud plot.\n\n\n\n\nThe above figure shows that the data are close to symmetry and the assumption of a normal distribution is reasonable.\nThe HDRS summary statistics for each group are:\n\nHDRS_summary <- depression %>%\n  group_by(intervention) %>%\n  dplyr::summarise(\n    n = n(),\n    min = min(HDRS, na.rm = TRUE),\n    q1 = quantile(HDRS, 0.25, na.rm = TRUE),\n    median = quantile(HDRS, 0.5, na.rm = TRUE),\n    q3 = quantile(HDRS, 0.75, na.rm = TRUE),\n    max = max(HDRS, na.rm = TRUE),\n    mean = mean(HDRS, na.rm = TRUE),\n    sd = sd(HDRS, na.rm = TRUE),\n    skewness = EnvStats::skewness(HDRS, na.rm = TRUE),\n    kurtosis= EnvStats::kurtosis(HDRS, na.rm = TRUE)\n  ) %>%\n  ungroup()\n\nHDRS_summary\n\n# A tibble: 2 × 11\n  intervention     n   min    q1 median    q3   max  mean    sd skewness kurto…¹\n  <fct>        <int> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>   <dbl>\n1 paroxetine      33    13    18     21    22    27  20.3  3.65  0.00167  -0.574\n2 placebo         43    14    19     21    24    28  21.5  3.41  0.0276   -0.403\n# … with abbreviated variable name ¹​kurtosis\n\n\nThe means are close to medians (20.3 vs 21 and 21.5 vs 21). The skewness is approximately zero (symmetric distribution) and the (excess) kurtosis falls into the acceptable range of [-1, 1] indicating approximately normal distributions for both groups.\nAlternatively, we can download the dlookr package and use the describe() function:\n\ndepression %>% \n  group_by(intervention) %>% \n  dlookr::describe(HDRS) %>% \n  select(described_variables,  intervention, n, mean, sd, p25, p50, p75, skewness, kurtosis) %>% \n  ungroup()\n\n# A tibble: 2 × 10\n  described_variab…¹ inter…²     n  mean    sd   p25   p50   p75 skewn…³ kurto…⁴\n  <chr>              <fct>   <int> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>   <dbl>\n1 HDRS               paroxe…    33  20.3  3.65    18    21    22 0.00167  -0.574\n2 HDRS               placebo    43  21.5  3.41    19    21    24 0.0276   -0.403\n# … with abbreviated variable names ¹​described_variables, ²​intervention,\n#   ³​skewness, ⁴​kurtosis"
  }
]