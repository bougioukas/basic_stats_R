[
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Basic Medical Statistics with R",
    "section": "License",
    "text": "License\nThis textbook is free to use, and is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 4.0 License."
  },
  {
    "objectID": "two_samples.html",
    "href": "two_samples.html",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "",
    "text": "When we have finished this Chapter, we should be able to:\nTwo sample t-test (Student’s t-test) can be used if we have two independent (unrelated) groups (e.g., males-females, treatment-non treatment) and one quantitative variable of interest."
  },
  {
    "objectID": "two_samples.html#research-question",
    "href": "two_samples.html#research-question",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.1 Research question",
    "text": "1.1 Research question\nIn an experiment designed to test the effectiveness of paroxetine for treating bipolar depression, the participants were randomly assigned into two groups (paroxetine Vs placebo). The researchers used the Hamilton Depression Rating Scale (HDRS) to measure the depression state of the participants and wanted to find out if the HDRS score is different in paroxetine group as compared to placebo group at the end of the experiment. The significance level \\(\\alpha\\) was set to 0.05.\nNote: A score of 0–7 in HDRS is generally accepted to be within the normal range, while a score of 20 or higher indicates at least moderate severity."
  },
  {
    "objectID": "two_samples.html#hypothesis-testsing",
    "href": "two_samples.html#hypothesis-testsing",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.2 Hypothesis Testsing",
    "text": "1.2 Hypothesis Testsing\n\n\n\n\n\n\nNull hypothesis and alternative hypothesis\n\n\n\n\n\n\\(H_0\\): the means of HDRS in the two groups are equal (\\(\\mu_{1} = \\mu_{2}\\))\n\n\\(H_1\\): the means of HDRS in the two groups are not equal (\\(\\mu_{1} \\neq \\mu_{2}\\))"
  },
  {
    "objectID": "two_samples.html#preraring-the-data",
    "href": "two_samples.html#preraring-the-data",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.3 Preraring the data",
    "text": "1.3 Preraring the data\nWe import the data in R:\n\nlibrary(readxl)\ndepression <- read_excel(here(\"data\", \"depression.xlsx\"))\n\n\n\n\nFigure 1.1: Table with data from “depression” file.\n\n\n\nWe inspect the data and the type of variables:\n\nglimpse(depression)\n\nRows: 76\nColumns: 2\n$ intervention <chr> \"placebo\", \"placebo\", \"placebo\", \"placebo\", \"placebo\", \"p…\n$ HDRS         <dbl> 19, 21, 28, 22, 22, 28, 23, 17, 19, 20, 26, 23, 23, 22, 1…\n\n\nThe data set depression has 76 patients (rows) and includes two variables (columns). The numeric (<dbl>) HDRS variable and the character (<chr>) intervention variable which should be converted to a factor (<fct>) variable using the factor() function as follows:\n\ndepression <- depression %>% \n  mutate(intervention = factor(intervention))\nglimpse(depression)\n\nRows: 76\nColumns: 2\n$ intervention <fct> placebo, placebo, placebo, placebo, placebo, placebo, pla…\n$ HDRS         <dbl> 19, 21, 28, 22, 22, 28, 23, 17, 19, 20, 26, 23, 23, 22, 1…"
  },
  {
    "objectID": "two_samples.html#assumptions",
    "href": "two_samples.html#assumptions",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.4 Assumptions",
    "text": "1.4 Assumptions\n\n\n\n\n\n\nCheck if the following assumptions are satisfied\n\n\n\n\nThe data are normally distributed in both groups\nThe data in both groups have similar variance (also named as homogeneity of variance or homoscedasticity)\n\n\n\nA. Explore the descriptive characteristics of distribution for each group and check for normality\nThe distributions can be explored visually with appropriate plots. Additionally, summary statistics and significance tests to check for normality (e.g., Shapiro-Wilk test) can be used.\n \nGraphs\nWe can visualize the distribution of HDRS for the two groups:\n\nset.seed(123)\nggplot(depression, aes(x=intervention, y=HDRS)) + \n  geom_flat_violin(aes(fill = intervention), scale = \"count\") +\n  geom_boxplot(width = 0.14, outlier.shape = NA, alpha = 0.5) +\n  geom_point(position = position_jitter(width = 0.05), \n             size = 1.2, alpha = 0.6) +\n  scale_fill_brewer(palette = \"Spectral\") +\n  theme_classic(base_size = 14) +\n  theme(legend.position=\"none\",\n        axis.text = element_text(size = 14))\n\n\n\nFigure 1.2: Rain cloud plot.\n\n\n\n\nThe above figure shows that the data are close to symmetry and the assumption of a normal distribution is reasonable.\n \nSummary statistics\nThe HDRS summary statistics for each group are:\n\nHDRS_summary <- depression %>%\n  group_by(intervention) %>%\n  dplyr::summarise(\n    n = n(),\n    min = min(HDRS, na.rm = TRUE),\n    q1 = quantile(HDRS, 0.25, na.rm = TRUE),\n    median = quantile(HDRS, 0.5, na.rm = TRUE),\n    q3 = quantile(HDRS, 0.75, na.rm = TRUE),\n    max = max(HDRS, na.rm = TRUE),\n    mean = mean(HDRS, na.rm = TRUE),\n    sd = sd(HDRS, na.rm = TRUE),\n    skewness = EnvStats::skewness(HDRS, na.rm = TRUE),\n    kurtosis= EnvStats::kurtosis(HDRS, na.rm = TRUE)\n  ) %>%\n  ungroup()\n\nHDRS_summary\n\n# A tibble: 2 × 11\n  intervention     n   min    q1 median    q3   max  mean    sd skewness kurto…¹\n  <fct>        <int> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>   <dbl>\n1 paroxetine      33    13    18     21    22    27  20.3  3.65  0.00167  -0.574\n2 placebo         43    14    19     21    24    28  21.5  3.41  0.0276   -0.403\n# … with abbreviated variable name ¹​kurtosis\n\n\nThe means are close to medians (20.3 vs 21 and 21.5 vs 21). The skewness is approximately zero (symmetric distribution) and the (excess) kurtosis falls into the acceptable range of [-1, 1] indicating approximately normal distributions for both groups.\nAlternatively, we can download the dlookr package and use the describe() function:\n\ndepression %>% \n  group_by(intervention) %>% \n  dlookr::describe(HDRS) %>% \n  select(described_variables,  intervention, n, mean, sd, p25, p50, p75, skewness, kurtosis) %>% \n  ungroup()\n\n# A tibble: 2 × 10\n  described_variab…¹ inter…²     n  mean    sd   p25   p50   p75 skewn…³ kurto…⁴\n  <chr>              <fct>   <int> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>   <dbl>\n1 HDRS               paroxe…    33  20.3  3.65    18    21    22 0.00167  -0.574\n2 HDRS               placebo    43  21.5  3.41    19    21    24 0.0276   -0.403\n# … with abbreviated variable names ¹​described_variables, ²​intervention,\n#   ³​skewness, ⁴​kurtosis\n\n\n \nNormality test\n\n\n\n\n\n\nRemember: Hypothesis testing for Shapiro-Wilk test for normality\n\n\n\n\\(H_{0}\\): the data came from a normally distributed population.\n\\(H_{1}\\): the data tested are not normally distributed.\n\nIf p − value < 0.05, reject the null hypothesis, \\(H_{0}\\).\nIf p − value ≥ 0.05, do not reject the null hypothesis, \\(H_{0}\\).\n\n\n\nThe Shapiro-Wilk test for normality for each group is:\n\ndepression %>%\n  group_by(intervention) %>%\n  shapiro_test(HDRS) %>% \n  ungroup()\n\n# A tibble: 2 × 4\n  intervention variable statistic     p\n  <fct>        <chr>        <dbl> <dbl>\n1 paroxetine   HDRS         0.976 0.670\n2 placebo      HDRS         0.979 0.614\n\n\nThe tests of normality suggest that the data for the HDRS in both groups are normally distributed (p=0.67 >0.05 and p=0.61 >0.05, respectively).\n \nB. Levene’s test for equality of variances\n\n\n\n\n\n\nRemember: Hypothesis testing for Levene’s test for equality of variances\n\n\n\n\\(H_{0}\\): the variances of HDRs in two groups are equal\n\\(H_{1}\\): the variances of HDRs in two groups are not equal\n\nIf p − value < 0.05, reject the null hypothesis, \\(H_{0}\\).\nIf p − value ≥ 0.05, do not reject the null hypothesis, \\(H_{0}\\).\n\n\n\nThe Levene’s test for equality of variances is:\n\ndepression %>% \n  levene_test(HDRS ~ intervention)\n\n# A tibble: 1 × 4\n    df1   df2 statistic     p\n  <int> <int>     <dbl> <dbl>\n1     1    74     0.176 0.676\n\n\nSince the p-value = 0.676 >0.05, the null hypothesis that the variances of HDRs in two groups are equal is not rejected."
  },
  {
    "objectID": "two_samples.html#run-the-t-test",
    "href": "two_samples.html#run-the-t-test",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.5 Run the t-test",
    "text": "1.5 Run the t-test\nWe will perform a pooled variance t-test (Student’s t-test) to test the null hypothesis that the mean HDRS score is the same for both groups (paroxetine and placebo).\n\n\n\n\n\n\nStudent’s t-test\n\n\n\n\n\nBase R\nrstatix\n\n\n\n\nt.test(HDRS ~ intervention, var.equal = T, data=depression)\n\n\n    Two Sample t-test\n\ndata:  HDRS by intervention\nt = -1.4185, df = 74, p-value = 0.1602\nalternative hypothesis: true difference in means between group paroxetine and group placebo is not equal to 0\n95 percent confidence interval:\n -2.777498  0.467420\nsample estimates:\nmean in group paroxetine    mean in group placebo \n                20.33333                 21.48837 \n\n\n\n\n\ndepression %>% \n    t_test(HDRS ~ intervention, var.equal = T, detailed = T)\n\n# A tibble: 1 × 15\n  estimate estimate1 estim…¹ .y.   group1 group2    n1    n2 stati…²     p    df\n*    <dbl>     <dbl>   <dbl> <chr> <chr>  <chr>  <int> <int>   <dbl> <dbl> <dbl>\n1    -1.16      20.3    21.5 HDRS  parox… place…    33    43   -1.42  0.16    74\n# … with 4 more variables: conf.low <dbl>, conf.high <dbl>, method <chr>,\n#   alternative <chr>, and abbreviated variable names ¹​estimate2, ²​statistic\n\n\n\n\n\n\n\nThe p-value = 0.16 is greater than 0.05. There is no evidence of a significant difference in mean HDRS between the two groups (failed to reject \\(H_0\\)). The difference between means (20.33 - 21.49) equals to -1.16 units of the HDRS and note that the 95% confidence interval of the difference in means (-2.78 to 0.47) includes the hypothesized null value of 0. Based on these results, there is not evidence that paroxetine is effective as a treatment for bipolar depression.\nNote that the paroxetine group (n= 33) has 33-1=32 degrees of freedom and the placebo sample (n= 43) has 43-1=42 df, so we have 32 + 42=74 df in total. Another way of thinking of this is that the complete sample size is 76, and we have estimated two parameters from the data (the two means), so we have 76-2 = 74 df.\nThe Student t-test for two independent samples does not have any restrictions on \\(n_1\\) and \\(n_2\\) —they can be equal or unequal. However, equal samples are preferred because when a total of 2n subjects are available, their equal division among the groups maximizes the power to detect a specified difference.\n\n\n\n\n\n\nRemember\n\n\n\nIf the variance is different between the two groups then the degrees of freedom and the t-value associated with a two-sample t-test are calculated differently. In this case, we have to write var.equal = F (or write nothing because this is the default) in the function so the Welch-Satterthwaite approximation is applied to the degrees of freedom.\n\n\n \nPresent the results in a summary table\n\n\n\n\n\n\n\nCharacteristic\n      \nOverall, N = 761\n\n      \nparoxetine, N = 331\n\n      \nplacebo, N = 431\n\n      \np-value2\n\n    \n\nHDRS score\n21.0 (3.5)\n20.3 (3.7)\n21.5 (3.4)\n0.16\n\n\n\n\n1 Mean (SD)\n    \n\n\n2 Two Sample t-test\n    \n\n\n\n\n\nHence, there is not evidence that HDRS score is significantly different in paroxetine group, mean (sd) 20.3 (3.7), as compared to placebo group, 21.5 (3.4), (mean difference= -1.16 units, 95% CI = -2.78 to 0.47, p = 0.16 >0.05)."
  }
]