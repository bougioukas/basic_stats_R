[
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Practical Statistics in Medicine with R",
    "section": "License",
    "text": "License\nThis textbook is free to use, and is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 4.0 License."
  },
  {
    "objectID": "student_t_test.html",
    "href": "student_t_test.html",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "",
    "text": "Two sample t-test (Student’s t-test) can be used if we have two independent (unrelated) groups (e.g., males-females, treatment-non treatment) and one quantitative variable of interest.\nWhen we have finished this Chapter, we should be able to:"
  },
  {
    "objectID": "student_t_test.html#research-question-and-hypothesis-testing",
    "href": "student_t_test.html#research-question-and-hypothesis-testing",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.1 Research question and Hypothesis Testing",
    "text": "1.1 Research question and Hypothesis Testing\nWe consider the data in depression dataset. In an experiment designed to test the effectiveness of paroxetine for treating bipolar depression, the participants were randomly assigned into two groups (paroxetine Vs placebo). The researchers used the Hamilton Depression Rating Scale (HDRS) to measure the depression state of the participants and wanted to find out if the HDRS score is different in paroxetine group as compared to placebo group at the end of the experiment. The significance level \\(\\alpha\\) was set to 0.05.\nNote: A score of 0–7 in HDRS is generally accepted to be within the normal range, while a score of 20 or higher indicates at least moderate severity.\n\n\n\n\n\n\nNull hypothesis and alternative hypothesis\n\n\n\n\n\n\\(H_0\\): the means of HDRS in the two groups are equal (\\(\\mu_{1} = \\mu_{2}\\))\n\n\\(H_1\\): the means of HDRS in the two groups are not equal (\\(\\mu_{1} \\neq \\mu_{2}\\))"
  },
  {
    "objectID": "student_t_test.html#packages-we-need",
    "href": "student_t_test.html#packages-we-need",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.2 Packages we need",
    "text": "1.2 Packages we need\nWe need to load the following packages:\n\nlibrary(rstatix)\nlibrary(PupillometryR)\nlibrary(gtsummary)\n\nlibrary(here)\nlibrary(tidyverse)"
  },
  {
    "objectID": "student_t_test.html#preraring-the-data",
    "href": "student_t_test.html#preraring-the-data",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.3 Preraring the data",
    "text": "1.3 Preraring the data\nWe import the data depression in R:\n\nlibrary(readxl)\ndepression <- read_excel(here(\"data\", \"depression.xlsx\"))\n\n\n\n\nFigure 1.1: Table with data from “depression” file.\n\n\n\nWe inspect the data and the type of variables:\n\nglimpse(depression)\n\nRows: 76\nColumns: 2\n$ intervention <chr> \"placebo\", \"placebo\", \"placebo\", \"placebo\", \"placebo\", \"p…\n$ HDRS         <dbl> 19, 21, 28, 22, 22, 28, 23, 17, 19, 20, 26, 23, 23, 22, 1…\n\n\nThe data set depression has 76 patients (rows) and includes two variables (columns). The numeric (<dbl>) HDRS variable and the character (<chr>) intervention variable which should be converted to a factor (<fct>) variable using the factor() function as follows:\n\ndepression <- depression %>% \n  mutate(intervention = factor(intervention))\nglimpse(depression)\n\nRows: 76\nColumns: 2\n$ intervention <fct> placebo, placebo, placebo, placebo, placebo, placebo, pla…\n$ HDRS         <dbl> 19, 21, 28, 22, 22, 28, 23, 17, 19, 20, 26, 23, 23, 22, 1…"
  },
  {
    "objectID": "student_t_test.html#assumptions",
    "href": "student_t_test.html#assumptions",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.4 Assumptions",
    "text": "1.4 Assumptions\n\n\n\n\n\n\nCheck if the following assumptions are satisfied\n\n\n\n\nThe data are normally distributed in both groups\nThe data in both groups have similar variance (also named as homogeneity of variance or homoscedasticity)\n\n\n\nA. Explore the characteristics of distribution for each group and check for normality\nThe distributions can be explored visually with appropriate plots. Additionally, summary statistics and significance tests to check for normality (e.g., Shapiro-Wilk test) can be used.\n \nGraphs\nWe can visualize the distribution of HDRS for the two groups:\n\nset.seed(123)\nggplot(depression, aes(x=intervention, y=HDRS)) + \n  geom_flat_violin(aes(fill = intervention), scale = \"count\") +\n  geom_boxplot(width = 0.14, outlier.shape = NA, alpha = 0.5) +\n  geom_point(position = position_jitter(width = 0.05), \n             size = 1.2, alpha = 0.6) +\n  ggsci::scale_fill_jco() +\n  theme_classic(base_size = 14) +\n  theme(legend.position=\"none\", \n        axis.text = element_text(size = 14))\n\n\n\nFigure 1.2: Rain cloud plot.\n\n\n\n\nThe above figure shows that the data are close to symmetry and the assumption of a normal distribution is reasonable.\n \nSummary statistics\nThe HDRS summary statistics for each group are:\n\n\n\n\n\n\nSummary statistics by group\n\n\n\n\n\ndplyr\ndlookr\n\n\n\n\nHDRS_summary <- depression %>%\n  group_by(intervention) %>%\n  dplyr::summarise(\n    n = n(),\n    min = min(HDRS, na.rm = TRUE),\n    q1 = quantile(HDRS, 0.25, na.rm = TRUE),\n    median = quantile(HDRS, 0.5, na.rm = TRUE),\n    q3 = quantile(HDRS, 0.75, na.rm = TRUE),\n    max = max(HDRS, na.rm = TRUE),\n    mean = mean(HDRS, na.rm = TRUE),\n    sd = sd(HDRS, na.rm = TRUE),\n    skewness = EnvStats::skewness(HDRS, na.rm = TRUE),\n    kurtosis= EnvStats::kurtosis(HDRS, na.rm = TRUE)\n  ) %>%\n  ungroup()\n\nHDRS_summary\n\n# A tibble: 2 × 11\n  intervention     n   min    q1 median    q3   max  mean    sd skewness kurto…¹\n  <fct>        <int> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>   <dbl>\n1 paroxetine      33    13    18     21    22    27  20.3  3.65  0.00167  -0.574\n2 placebo         43    14    19     21    24    28  21.5  3.41  0.0276   -0.403\n# … with abbreviated variable name ¹​kurtosis\n\n\n\n\n\ndepression %>% \n  group_by(intervention) %>% \n  dlookr::describe(HDRS) %>% \n  select(described_variables,  intervention, n, mean, sd, p25, p50, p75, skewness, kurtosis) %>% \n  ungroup()\n\n# A tibble: 2 × 10\n  described_variab…¹ inter…²     n  mean    sd   p25   p50   p75 skewn…³ kurto…⁴\n  <chr>              <fct>   <int> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>   <dbl>\n1 HDRS               paroxe…    33  20.3  3.65    18    21    22 0.00167  -0.574\n2 HDRS               placebo    43  21.5  3.41    19    21    24 0.0276   -0.403\n# … with abbreviated variable names ¹​described_variables, ²​intervention,\n#   ³​skewness, ⁴​kurtosis\n\n\n\n\n\n\n\nThe means are close to medians (20.3 vs 21 and 21.5 vs 21). The skewness is approximately zero (symmetric distribution) and the (excess) kurtosis falls into the acceptable range of [-1, 1] indicating approximately normal distributions for both groups.\n \nNormality test\n\n\n\n\n\n\nRemember: Hypothesis testing for Shapiro-Wilk test for normality\n\n\n\n\\(H_{0}\\): the data came from a normally distributed population.\n\\(H_{1}\\): the data tested are not normally distributed.\n\nIf p − value < 0.05, reject the null hypothesis, \\(H_{0}\\).\nIf p − value ≥ 0.05, do not reject the null hypothesis, \\(H_{0}\\).\n\n\n\nThe Shapiro-Wilk test for normality for each group is:\n\ndepression %>%\n  group_by(intervention) %>%\n  shapiro_test(HDRS) %>% \n  ungroup()\n\n# A tibble: 2 × 4\n  intervention variable statistic     p\n  <fct>        <chr>        <dbl> <dbl>\n1 paroxetine   HDRS         0.976 0.670\n2 placebo      HDRS         0.979 0.614\n\n\nThe tests of normality suggest that the data for the HDRS in both groups are normally distributed (p=0.67 >0.05 and p=0.61 >0.05, respectively).\n \nB. Levene’s test for equality of variances\n\n\n\n\n\n\nRemember: Hypothesis testing for Levene’s test for equality of variances\n\n\n\n\\(H_{0}\\): the variances of HDRs in two groups are equal\n\\(H_{1}\\): the variances of HDRs in two groups are not equal\n\nIf p − value < 0.05, reject the null hypothesis, \\(H_{0}\\).\nIf p − value ≥ 0.05, do not reject the null hypothesis, \\(H_{0}\\).\n\n\n\nThe Levene’s test for equality of variances is:\n\ndepression %>% \n  levene_test(HDRS ~ intervention)\n\n# A tibble: 1 × 4\n    df1   df2 statistic     p\n  <int> <int>     <dbl> <dbl>\n1     1    74     0.176 0.676\n\n\nSince the p-value = 0.676 >0.05, the null hypothesis that the variances of HDRs in two groups are equal is not rejected."
  },
  {
    "objectID": "student_t_test.html#run-the-t-test",
    "href": "student_t_test.html#run-the-t-test",
    "title": "1  Two-sample t-test (Student’s t-test)",
    "section": "\n1.5 Run the t-test",
    "text": "1.5 Run the t-test\nWe will perform a pooled variance t-test (Student’s t-test) to test the null hypothesis that the mean HDRS score is the same for both groups (paroxetine and placebo).\n\n\n\n\n\n\nStudent’s t-test\n\n\n\n\n\nBase R\nrstatix\n\n\n\n\nt.test(HDRS ~ intervention, var.equal = T, data=depression)\n\n\n    Two Sample t-test\n\ndata:  HDRS by intervention\nt = -1.4185, df = 74, p-value = 0.1602\nalternative hypothesis: true difference in means between group paroxetine and group placebo is not equal to 0\n95 percent confidence interval:\n -2.777498  0.467420\nsample estimates:\nmean in group paroxetine    mean in group placebo \n                20.33333                 21.48837 \n\n\n\n\n\ndepression %>% \n    t_test(HDRS ~ intervention, var.equal = T, detailed = T)\n\n# A tibble: 1 × 15\n  estimate estimate1 estim…¹ .y.   group1 group2    n1    n2 stati…²     p    df\n*    <dbl>     <dbl>   <dbl> <chr> <chr>  <chr>  <int> <int>   <dbl> <dbl> <dbl>\n1    -1.16      20.3    21.5 HDRS  parox… place…    33    43   -1.42  0.16    74\n# … with 4 more variables: conf.low <dbl>, conf.high <dbl>, method <chr>,\n#   alternative <chr>, and abbreviated variable names ¹​estimate2, ²​statistic\n\n\n\n\n\n\n\nThe p-value = 0.16 is greater than 0.05. There is no evidence of a significant difference in mean HDRS between the two groups (failed to reject \\(H_0\\)). The difference between means (20.33 - 21.49) equals to -1.16 units of the HDRS and note that the 95% confidence interval of the difference in means (-2.78 to 0.47) includes the hypothesized null value of 0. Based on these results, there is not evidence that paroxetine is effective as a treatment for bipolar depression.\nNote that the paroxetine group (n=33) has df (degrees of freedom) = 33-1 = 32 and the placebo sample (n= 43) has df = 43-1 = 42 , so we have df = 32 + 42 = 74 in total. Another way of thinking of this is that the complete sample size is 76, and we have estimated two parameters from the data (the two means), so we have df = 76-2 = 74 .\nThe Student t-test for two independent samples does not have any restrictions on \\(n_1\\) and \\(n_2\\) —they can be equal or unequal. However, equal samples are preferred because when a total of 2n subjects are available, their equal division among the groups maximizes the power to detect a specified difference.\n\n\n\n\n\n\nRemember\n\n\n\nIf the variance is different between the two groups then the degrees of freedom and the t-value associated with a two-sample t-test are calculated differently. In this case, we have to write var.equal = F (or write nothing because this is the default) in the function so the Welch-Satterthwaite approximation is applied to the degrees of freedom.\n\n\n \nPresent the results in a summary table\n\nShow the codegt_sum1 <- depression %>% \n  tbl_summary(\n    by = intervention, \n    statistic = HDRS ~ \"{mean} ({sd})\", \n    digits = list(everything() ~ 1),\n    label = list(HDRS ~ \"HDRS score\"), \n    missing = c(\"no\")) %>% \n  add_p(test = HDRS ~ \"t.test\", purrr::partial(style_pvalue, digits = 2),\n        test.args = all_tests(\"t.test\") ~ list(var.equal = TRUE)) %>% \n  add_overall() %>%\n  as_gt() \n\ngt_sum1\n\n\n\n\n\n\nCharacteristic\n      \nOverall, N = 761\n\n      \nparoxetine, N = 331\n\n      \nplacebo, N = 431\n\n      \np-value2\n\n    \n\nHDRS score\n21.0 (3.5)\n20.3 (3.7)\n21.5 (3.4)\n0.16\n\n\n\n\n1 Mean (SD)\n    \n\n\n2 Two Sample t-test\n    \n\n\n\n\n\nHence, there is not evidence that HDRS score is significantly different in paroxetine group, mean = 20.3 (sd = 3.7), as compared to placebo group, 21.5 (3.4), (mean difference= -1.16 units, 95% CI = -2.78 to 0.47, p = 0.16 >0.05)."
  },
  {
    "objectID": "wmw_test.html",
    "href": "wmw_test.html",
    "title": "2  Wilcoxon-Mann-Whitney (Mann-Whitney U) test",
    "section": "",
    "text": "The Wilcoxon-Mann-Whitney (WMW) test (sometimes called Mann-Whitney U test or Wilcoxon Rank Sum test) is used to compare two independent samples and is often considered the non-parametric alternative to the Student’s t-test when there is violation of normality or for small sample sizes. However, if the samples are very small (both smaller than four observations) then statistical significance is impossible.\nWhen we have finished this Chapter, we should be able to:"
  },
  {
    "objectID": "wmw_test.html#research-question-and-hypothesis-testing",
    "href": "wmw_test.html#research-question-and-hypothesis-testing",
    "title": "2  Wilcoxon-Mann-Whitney (Mann-Whitney U) test",
    "section": "\n2.1 Research question and Hypothesis Testing",
    "text": "2.1 Research question and Hypothesis Testing\nWe consider the data in thromboglobulin dataset that contains the urinary \\(\\beta\\) thromboglobulin excretion (pg/ml) measured in 12 non-diabetic patients and 12 diabetic patients. The researchers used \\(\\alpha\\) = 0.05 significance level to test if the distribution of urinary \\(\\beta\\) thromboglobulin (b_TG) differs in the two groups.\n\n\n\n\n\n\nNull hypothesis and alternative hypothesis\n\n\n\n\n\n\\(H_0\\): the distribution of urinary \\(\\beta\\) thromboglobulin is the same in the two groups\n\n\\(H_1\\): the distribution of urinary \\(\\beta\\) thromboglobulin is different in the two groups\n\n\n\nNOTE: The null hypothesis is that the observations from one group do not tend to have a higher or lower ranking than observations from the other group. This test does not test the medians of the data as is commonly thought, it tests the whole distribution. In practice, however, we use the medians to present the results. Statistical speaking, if the distributions of the two groups have similar shapes, the Wilcoxon-Mann-Whitney test can be used to determine whether there are differences in the medians between the two groups."
  },
  {
    "objectID": "wmw_test.html#packages-we-need",
    "href": "wmw_test.html#packages-we-need",
    "title": "2  Wilcoxon-Mann-Whitney (Mann-Whitney U) test",
    "section": "\n2.2 Packages we need",
    "text": "2.2 Packages we need\nWe need to load the following packages:\n\nlibrary(rstatix)\nlibrary(PupillometryR)\nlibrary(gtsummary)\n\nlibrary(here)\nlibrary(tidyverse)"
  },
  {
    "objectID": "wmw_test.html#preraring-the-data",
    "href": "wmw_test.html#preraring-the-data",
    "title": "2  Wilcoxon-Mann-Whitney (Mann-Whitney U) test",
    "section": "\n2.3 Preraring the data",
    "text": "2.3 Preraring the data\nWe import the data thromboglobulin in R:\n\nlibrary(readxl)\ntg <- read_excel(here(\"data\", \"thromboglobulin.xlsx\"))\n\n\n\n\nFigure 2.1: Table with data from “depression” file.\n\n\n\nWe inspect the data and the type of variables:\n\nglimpse(tg)\n\nRows: 24\nColumns: 2\n$ status <chr> \"non-diabetic\", \"non-diabetic\", \"non-diabetic\", \"non-diabetic\",…\n$ b_TG   <dbl> 4.1, 6.3, 7.8, 8.5, 8.9, 10.4, 11.5, 12.0, 13.8, 17.6, 24.3, 37…\n\n\nThe data set tg has 24 patients (rows) and includes two variables (columns). The numeric (<dbl>) b_TG variable and the character (<chr>) status variable which should be converted to a factor (<fct>) variable using the factor() function as follows:\n\ntg <- tg %>% \n  mutate(status = factor(status))\nglimpse(tg)\n\nRows: 24\nColumns: 2\n$ status <fct> non-diabetic, non-diabetic, non-diabetic, non-diabetic, non-dia…\n$ b_TG   <dbl> 4.1, 6.3, 7.8, 8.5, 8.9, 10.4, 11.5, 12.0, 13.8, 17.6, 24.3, 37…"
  },
  {
    "objectID": "wmw_test.html#explore-the-characteristics-of-distribution-for-each-group-and-check-for-normality",
    "href": "wmw_test.html#explore-the-characteristics-of-distribution-for-each-group-and-check-for-normality",
    "title": "2  Wilcoxon-Mann-Whitney (Mann-Whitney U) test",
    "section": "\n2.4 Explore the characteristics of distribution for each group and check for normality",
    "text": "2.4 Explore the characteristics of distribution for each group and check for normality\nThe distributions can be explored visually with appropriate plots. Additionally, summary statistics and significance tests to check for normality (e.g., Shapiro-Wilk test) can be used.\n \nGraph\nWe can visualize the distribution of b_TG for the two groups:\n\nset.seed(123)\nggplot(tg, aes(x=status, y=b_TG)) + \n  geom_flat_violin(aes(fill = status), scale = \"count\") +\n  geom_boxplot(width = 0.14, outlier.shape = NA, alpha = 0.5) +\n  geom_point(position = position_jitter(width = 0.05), \n             size = 1.2, alpha = 0.6) +\n  ggsci::scale_fill_jco() +\n  theme_classic(base_size = 14) +\n  theme(legend.position=\"none\", \n        axis.text = element_text(size = 14))\n\n\n\nFigure 2.2: Rain cloud plot.\n\n\n\n\nThe above figure shows that the data in both groups are positively skewed and they have similar shaped distributions.\n \nSummary statistics\nThe g_TG summary statistics for each group are:\n\n\n\n\n\n\nSummary statistics by group\n\n\n\n\n\ndplyr\ndlookr\n\n\n\n\ntg_summary <- tg %>%\n  group_by(status) %>%\n  dplyr::summarise(\n    n = n(),\n    min = min(b_TG, na.rm = TRUE),\n    q1 = quantile(b_TG, 0.25, na.rm = TRUE),\n    median = quantile(b_TG, 0.5, na.rm = TRUE),\n    q3 = quantile(b_TG, 0.75, na.rm = TRUE),\n    max = max(b_TG, na.rm = TRUE),\n    mean = mean(b_TG, na.rm = TRUE),\n    sd = sd(b_TG, na.rm = TRUE),\n    skewness = EnvStats::skewness(b_TG, na.rm = TRUE),\n    kurtosis= EnvStats::kurtosis(b_TG, na.rm = TRUE)\n  ) %>%\n  ungroup()\n\ntg_summary\n\n# A tibble: 2 × 11\n  status           n   min    q1 median    q3   max  mean    sd skewness kurto…¹\n  <fct>        <int> <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>   <dbl>\n1 diabetic        12  23.8 27.2    29.2  34.8  46.2  31.8  7.17     1.05   0.107\n2 non-diabetic    12   4.1  8.32   11.0  14.8  37.2  13.5  9.19     1.81   3.47 \n# … with abbreviated variable name ¹​kurtosis\n\n\n\n\n\ntg %>% \n  group_by(status) %>% \n  dlookr::describe(b_TG) %>% \n  select(described_variables,  status, n, mean, sd, p25, p50, p75, skewness, kurtosis) %>% \n  ungroup()\n\n# A tibble: 2 × 10\n  described_variables status     n  mean    sd   p25   p50   p75 skewn…¹ kurto…²\n  <chr>               <fct>  <int> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl>   <dbl>\n1 b_TG                diabe…    12  31.8  7.17 27.2   29.2  34.8    1.05   0.107\n2 b_TG                non-d…    12  13.5  9.19  8.32  11.0  14.8    1.81   3.47 \n# … with abbreviated variable names ¹​skewness, ²​kurtosis\n\n\n\n\n\n\n\nThe means are not very close to the medians (31.8 vs 29.2 and 13.5 vs 11.0). Moreover, both the skewness and the (excess) kurtosis for the non-diabetic group falls outside of the acceptable range of [-1, 1] indicating right-skewed and leptokurtic distribution.\n \nNormality test\nThe Shapiro-Wilk test for normality for each group is:\n\ntg %>%\n  group_by(status) %>%\n  shapiro_test(b_TG) %>% \n  ungroup()\n\n# A tibble: 2 × 4\n  status       variable statistic      p\n  <fct>        <chr>        <dbl>  <dbl>\n1 diabetic     b_TG         0.886 0.105 \n2 non-diabetic b_TG         0.817 0.0148\n\n\nWe can see that the data for the non-diabetic group is not normally distributed (p=0.015 <0.05) according to the Shapiro-Wilk test."
  },
  {
    "objectID": "wmw_test.html#run-the-wilcoxon-mann-whitney-test",
    "href": "wmw_test.html#run-the-wilcoxon-mann-whitney-test",
    "title": "2  Wilcoxon-Mann-Whitney (Mann-Whitney U) test",
    "section": "\n2.5 Run the Wilcoxon-Mann-Whitney test",
    "text": "2.5 Run the Wilcoxon-Mann-Whitney test\nThe difference in medians between the two groups can be tested using a rank test such as Wilcoxon-Mann-Whitney (WMW):\n\n\n\n\n\n\nWilcoxon-Mann-Whitney test\n\n\n\n\n\nBase R\nexactRankTests\nrstatix\n\n\n\n\nwilcox.test(b_TG ~ status, conf.int = T, data = tg)\n\n\n    Wilcoxon rank sum exact test\n\ndata:  b_TG by status\nW = 134, p-value = 0.0001028\nalternative hypothesis: true location shift is not equal to 0\n95 percent confidence interval:\n 13.7 24.0\nsample estimates:\ndifference in location \n                 18.95 \n\n\nHistorical Note: As you can see, in R the Mann-Whitney statistic (symbolized as W) is calculated with the wilcox.test() function and it is called Wilcoxon rank-sum test. What is the reason for this? Henry Mann and Donald Whitney (1947) reported in their article that the test was first proposed by Frank Wilcoxon (1945) and they gave their version for the test. So the right would be to call this test Wilcoxon-Mann-Whitney (WMW) test.\n\n\nAlthough a small number of ties should not have a serious impact on our results, in case of ties we can use the wilcox.exact() function from the package {exactRankTests}:\n\nwilcox.exact(b_TG ~ status, conf.int = T, data = tg)\n\n\n    Exact Wilcoxon rank sum test\n\ndata:  b_TG by status\nW = 134, p-value = 0.0001028\nalternative hypothesis: true mu is not equal to 0\n95 percent confidence interval:\n 13.7 24.0\nsample estimates:\ndifference in location \n                 18.95 \n\n\n\n\n\ntg %>%\n  wilcox_test(b_TG ~ status, detailed = T)\n\n# A tibble: 1 × 12\n  estim…¹ .y.   group1 group2    n1    n2 stati…²       p conf.…³ conf.…⁴ method\n*   <dbl> <chr> <chr>  <chr>  <int> <int>   <dbl>   <dbl>   <dbl>   <dbl> <chr> \n1    19.0 b_TG  diabe… non-d…    12    12     134 1.03e-4    13.7      24 Wilco…\n# … with 1 more variable: alternative <chr>, and abbreviated variable names\n#   ¹​estimate, ²​statistic, ³​conf.low, ⁴​conf.high\n\n\n\n\n\n\n\nBased on the p <0.001, we reject the null hypothesis, the result (difference in medians = 18.95, 95% CI: 13.7 to 24) is significant.\n \nPresent the results in a summary table\nThe median (or another percentile) can be used as a summary measure. The choice is guided by the shape of the distributions.\n\nShow the codegt_sum2 <- tg %>% \n  tbl_summary(\n    by = status, \n    statistic = b_TG ~ \"{median} ({p25}, {p75})\", \n    digits = list(everything() ~ 1),\n    label = list(b_TG ~ \"b_TG \\n(pg/ml)\"), \n    missing = c(\"no\")) %>% \n  add_p(test = b_TG ~ \"wilcox.test\") %>% \n  add_overall() %>%\n  as_gt() \n\ngt_sum2\n\n\n\n\n\n\nCharacteristic\n      \nOverall, N = 241\n\n      \ndiabetic, N = 121\n\n      \nnon-diabetic, N = 121\n\n      \np-value2\n\n    \n\nb_TG \n(pg/ml)\n24.6 (11.2, 30.2)\n29.2 (27.1, 34.8)\n10.9 (8.3, 14.8)\n<0.001\n\n\n\n\n1 Median (IQR)\n    \n\n\n2 Wilcoxon rank sum exact test\n    \n\n\n\n\n\nHence, the urinary \\(\\beta\\) thromboglobulin excretion is significantly higher in diabetic group, median = 29.2 (IQR: 27.1, 34.8) pg/ml, as compared to non-diabetic group, 10.9 (8.3, 14.8) pg/ml, (p <0.001)."
  },
  {
    "objectID": "paired_t_test.html",
    "href": "paired_t_test.html",
    "title": "3  Paired t-test",
    "section": "",
    "text": "A paired t-test is used to estimate whether the means of two related measurements are significantly different from one another.\nExamples of paired study designs are:\nWhen we have finished this Chapter, we should be able to:"
  },
  {
    "objectID": "paired_t_test.html#research-question",
    "href": "paired_t_test.html#research-question",
    "title": "3  Paired t-test",
    "section": "\n3.1 Research question",
    "text": "3.1 Research question\nThe dataset weight contains the birth and discharge weight of 25 newborns. We might ask if the mean difference of the weight in birth and in discharge equals to zero or not. If the differences between the pairs of measurements are normally distributed, a paired t-test is the most appropriate statistical test.\n\n\n\n\n\n\nNull hypothesis and alternative hypothesis\n\n\n\n\n\n\\(H_0\\): the mean difference of weight equals to zero (\\(\\mu_{d} = 0\\))\n\n\\(H_1\\): the mean difference of weight does not equal to zero (\\(\\mu_{d} \\neq 0\\))"
  },
  {
    "objectID": "paired_t_test.html#packages-we-need",
    "href": "paired_t_test.html#packages-we-need",
    "title": "3  Paired t-test",
    "section": "\n3.2 Packages we need",
    "text": "3.2 Packages we need\nWe need to load the following packages:\n\nlibrary(rstatix)\nlibrary(gtsummary)\n\nlibrary(here)\nlibrary(tidyverse)"
  },
  {
    "objectID": "paired_t_test.html#preraring-the-data",
    "href": "paired_t_test.html#preraring-the-data",
    "title": "3  Paired t-test",
    "section": "\n3.3 Preraring the data",
    "text": "3.3 Preraring the data\nWe import the data weight in R:\n\nlibrary(readxl)\nweight <- read_excel(here(\"data\", \"weight.xlsx\"))\n\nWe calculate the differences using the mutate() function:\n\nweight <- weight %>%\n  mutate(dif_weight = birth_weight - discharge_weight)\n\n\n\n\nFigure 3.1: Table with data from “weight” file.\n\n\n\nWe inspect the data:\n\nglimpse(weight) \n\nRows: 25\nColumns: 3\n$ birth_weight     <dbl> 3250, 2680, 2960, 3420, 3210, 2740, 3250, 3170, 2970,…\n$ discharge_weight <dbl> 3220, 2640, 2940, 3350, 3140, 2730, 3220, 3150, 2890,…\n$ dif_weight       <dbl> 30, 40, 20, 70, 70, 10, 30, 20, 80, 103, 84, 42, -15,…"
  },
  {
    "objectID": "paired_t_test.html#assumptions",
    "href": "paired_t_test.html#assumptions",
    "title": "3  Paired t-test",
    "section": "\n3.4 Assumptions",
    "text": "3.4 Assumptions\n\n\n\n\n\n\nCheck if the following assumption is satisfied\n\n\n\nThe differences are normally distributed."
  },
  {
    "objectID": "paired_t_test.html#explore-the-characteristics-of-distribution-of-differences",
    "href": "paired_t_test.html#explore-the-characteristics-of-distribution-of-differences",
    "title": "3  Paired t-test",
    "section": "\n3.5 Explore the characteristics of distribution of differences",
    "text": "3.5 Explore the characteristics of distribution of differences\nThe distribution of the differences can be explored with appropriate plots and summary statistics.\nGraph\nWe can explore the distribution of differences visually for symmetry with a density plot (a smoothed version of the histogram):\n\nweight %>%\n  ggplot(aes(x = dif_weight)) +\n  geom_density(fill = \"#76B7B2\", color=\"black\", alpha = 0.2) +\n  geom_vline(aes(xintercept=mean(dif_weight)),\n             color=\"blue\", linetype=\"dashed\", size=1.4) +\n  geom_vline(aes(xintercept=median(dif_weight)),\n             color=\"red\", linetype=\"dashed\", size=1.2) +\n  labs(x = \"Weight difference\") +\n  theme_minimal() +\n  theme(plot.title.position = \"plot\")\n\n\n\nFigure 3.2: Density plot of the weight differences.\n\n\n\n\nThe above figure shows that the data are following an approximately symmetrical distribution. Note that the arethmetic mean (blue vertical dashed line) is very close to the median (red vertical dashed line) of the data.\nSummary statistics\nSummary statistics can also be calculated for the variables.\n\n\n\n\n\n\nSummary statistics\n\n\n\n\n\ndplyr\ndlookr\n\n\n\nWe can utilize the new across() function to obtain the results across the three variables simultaneously:\n\nsummary_weight <- weight %>%\n  dplyr::summarise(across(\n    .cols = c(dif_weight, birth_weight, discharge_weight), \n    .fns = list(\n    N = ~n(),\n    Min = min,\n    Q1 = ~quantile(., 0.25),\n    median = median,\n    Q3 = ~quantile(., 0.75),\n    Max = max,\n    Mean = mean,\n    Sd = sd,\n    Skewness = EnvStats::skewness,\n    Kurtosis= EnvStats::kurtosis\n    ), na.rm = TRUE,\n    .names = \"{col}_{fn}\")\n    )\n\n# present the results\nsummary_weight <- summary_weight %>% \n  mutate(across(everything(), round, 2)) %>%   # round to 3 decimal places\n  pivot_longer(1:30, names_to = \"Stats\", values_to = \"Values\")  # long format\n\nsummary_weight\n\n# A tibble: 30 × 2\n   Stats               Values\n   <chr>                <dbl>\n 1 dif_weight_N         25   \n 2 dif_weight_Min      -30   \n 3 dif_weight_Q1        20   \n 4 dif_weight_median    40   \n 5 dif_weight_Q3        70   \n 6 dif_weight_Max      103   \n 7 dif_weight_Mean      39.6 \n 8 dif_weight_Sd        32.3 \n 9 dif_weight_Skewness  -0.16\n10 dif_weight_Kurtosis  -0.08\n# … with 20 more rows\n\n\n\n\n\nweight %>% \n  dlookr::describe(dif_weight, birth_weight, discharge_weight) %>% \n  select(described_variables, n, mean, sd, p25, p50, p75, skewness, kurtosis) %>% \n  ungroup()\n\n# A tibble: 3 × 9\n  described_variables     n   mean    sd   p25   p50   p75 skewness kurtosis\n  <chr>               <int>  <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl>\n1 dif_weight             25   39.6  32.3    20    40    70   -0.157  -0.0752\n2 birth_weight           25 3076.  248.   2960  3150  3210   -0.291  -0.935 \n3 discharge_weight       25 3036.  248.   2880  3100  3220   -0.219  -1.02  \n\n\n\n\n\n\n\nAs it was previously mentioned, the mean of the differences (39.64) is close to median (40). Moreover, both the skewness and the kurtosis are approximately zero indicating a symmetric and mesokurtic distribution for the weight differences.\nNormality test\nAdditionally, we can check the statistical test for normality of the differences.\n\n weight %>%\n    shapiro_test(dif_weight)\n\n# A tibble: 1 × 3\n  variable   statistic     p\n  <chr>          <dbl> <dbl>\n1 dif_weight     0.974 0.742\n\n\nThe Shapiro-Wilk test suggests that the weight differences are normally distributed (p=0.74 > 0.05)."
  },
  {
    "objectID": "paired_t_test.html#run-the-paired-t-test",
    "href": "paired_t_test.html#run-the-paired-t-test",
    "title": "3  Paired t-test",
    "section": "\n3.6 Run the paired t-test",
    "text": "3.6 Run the paired t-test\nWe will perform a paired t-test to test the null hypothesis that the mean differences of weight equals to zero.\n\n\n\n\n\n\nPaired t-test\n\n\n\n\n\nBase R (1st way)\nBase R (2nd way)\nrstatix\n\n\n\nOur data are in a wide format. However, we are going to use only the dif_weight variable, inside the t.test():\n\nt.test(weight$dif_weight)\n\n\n    One Sample t-test\n\ndata:  weight$dif_weight\nt = 6.1428, df = 24, p-value = 2.401e-06\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 26.32139 52.95861\nsample estimates:\nmean of x \n    39.64 \n\n\n\n\n\nt.test(weight$birth_weight, weight$discharge_weight, paired = T)\n\n\n    Paired t-test\n\ndata:  weight$birth_weight and weight$discharge_weight\nt = 6.1428, df = 24, p-value = 2.401e-06\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 26.32139 52.95861\nsample estimates:\nmean difference \n          39.64 \n\n\n\n\n\nweight %>% \n  t_test(dif_weight ~ 1, detailed = T)\n\n# A tibble: 1 × 12\n  estimate .y.   group1 group2     n stati…¹      p    df conf.…² conf.…³ method\n*    <dbl> <chr> <chr>  <chr>  <int>   <dbl>  <dbl> <dbl>   <dbl>   <dbl> <chr> \n1     39.6 dif_… 1      null …    25    6.14 2.4e-6    24    26.3    53.0 T-test\n# … with 1 more variable: alternative <chr>, and abbreviated variable names\n#   ¹​statistic, ²​conf.low, ³​conf.high"
  },
  {
    "objectID": "paired_t_test.html#present-the-results-in-a-summary-table",
    "href": "paired_t_test.html#present-the-results-in-a-summary-table",
    "title": "3  Paired t-test",
    "section": "\n3.7 Present the results in a summary table",
    "text": "3.7 Present the results in a summary table\n\nShow the codetb1 <- weight %>% \n  mutate(id = row_number()) %>% \n  select(-dif_weight) %>% \n  pivot_longer(!id, names_to = \"group\", values_to = \"weights\")\n\ngt_sum3 <- tb1 %>% \ntbl_summary(by = group, include = -id,\n            label = list(weights ~ \"weights (grams)\"),\n            statistic =  weights ~ \"{mean} ({sd})\") %>%\n  #add_difference(test = weights ~ \"paired.t.test\", group = id) %>%\n  add_p(test = weights ~ \"paired.t.test\", group = id) %>% \n  #modify_spanning_header(all_stat_cols() ~ \"**Weight**\") %>% \n  as_gt()\n  \ngt_sum3 \n\n\n\n\n\n\nCharacteristic\n      \nbirth_weight, N = 251\n\n      \ndischarge_weight, N = 251\n\n      \np-value2\n\n    \n\nweights (grams)\n3,076 (248)\n3,036 (248)\n<0.001\n\n\n\n\n1 Mean (SD)\n    \n\n\n2 Paired t-test\n    \n\n\n\n\n\nThere was a significant reduction in weight (39.6 g) after the discharge (p-value <0.001 that is lower than 0.05; reject \\(H_0\\)). Note that the 95% confidence interval (26.3 to 52.9) doesn’t include the null hypothesized value of 0. However, is this reduction of clinical importance?"
  },
  {
    "objectID": "wilcoxon_test.html",
    "href": "wilcoxon_test.html",
    "title": "4  Wilcoxon Signed-Rank test",
    "section": "",
    "text": "Wilcoxon Signed-Rank test (Wilcoxon test) is a non-parametric test that can be conducted to compare paired samples when the differences are not normally distributed. It is based on the signs of the differences and the magnitude of the rank of the differences between pairs of measurements, rather than the actual values. The null hypothesis is that there is no tendency for values under each paired variable to be higher or lower. It is often thought of as a test for small samples. However, if the sample is smaller than 6, then statistical significance is impossible.\nWhen we have finished this Chapter, we should be able to:"
  },
  {
    "objectID": "wilcoxon_test.html#research-question",
    "href": "wilcoxon_test.html#research-question",
    "title": "4  Wilcoxon Signed-Rank test",
    "section": "\n4.1 Research question",
    "text": "4.1 Research question\nThe dataset eyes contains thickness of the cornea (in microns) in patients with one eye affected by glaucoma; the other eye is unaffected. We investigate if there is evidence for difference in corneal thickness in affected and unaffected eyes.\n\n\n\n\n\n\nNull hypothesis and alternative hypothesis\n\n\n\n\n\\(H_0\\): The distribution of the differences in thickness of the cornea is symmetrical about zero\n\\(H_1\\): The distribution of the differences in thickness of the cornea is not symmetrical about zero\n\n\n\nNOTE: If we are testing the null hypothesis that the median of the paired rank differences is zero, then the paired rank differences must all come from a symmetrical distribution. Note that we do not have to assume that the distributions of the original populations are symmetrical - two very positively skewed distributions that differ only by location will produce a set of paired rank differences that are symmetrical."
  },
  {
    "objectID": "wilcoxon_test.html#packages-we-need",
    "href": "wilcoxon_test.html#packages-we-need",
    "title": "4  Wilcoxon Signed-Rank test",
    "section": "\n4.2 Packages we need",
    "text": "4.2 Packages we need\nWe need to load the following packages:\n\nlibrary(rstatix)\nlibrary(gtsummary)\n\nlibrary(here)\nlibrary(tidyverse)"
  },
  {
    "objectID": "wilcoxon_test.html#preraring-the-data",
    "href": "wilcoxon_test.html#preraring-the-data",
    "title": "4  Wilcoxon Signed-Rank test",
    "section": "\n4.3 Preraring the data",
    "text": "4.3 Preraring the data\nWe import the data eyes in R:\n\nlibrary(readxl)\neyes <- read_excel(here(\"data\", \"eyes.xlsx\"))\n\nWe calculate the differences using the function mutate():\n\neyes <- eyes %>%\n  mutate(dif_thickness = affected_eye - unaffected_eye)\n\n\n\n\nFigure 4.1: Table with data from “weight” file.\n\n\n\nWe inspect the data:\n\nglimpse(eyes) \n\nRows: 8\nColumns: 4\n$ id             <dbl> 1, 2, 3, 4, 5, 6, 7, 8\n$ affected_eye   <dbl> 488, 478, 480, 426, 440, 410, 458, 460\n$ unaffected_eye <dbl> 484, 478, 492, 444, 436, 398, 464, 476\n$ dif_thickness  <dbl> 4, 0, -12, -18, 4, 12, -6, -16"
  },
  {
    "objectID": "wilcoxon_test.html#explore-the-characteristics-of-distribution-of-differences",
    "href": "wilcoxon_test.html#explore-the-characteristics-of-distribution-of-differences",
    "title": "4  Wilcoxon Signed-Rank test",
    "section": "\n4.4 Explore the characteristics of distribution of differences",
    "text": "4.4 Explore the characteristics of distribution of differences\nThe distributions of differences can be explored with appropriate plots and summary statistics.\nGraph\nWe can explore the data visually for symmetry with a density plot.\n\neyes %>%\n  ggplot(aes(x = dif_thickness)) +\n  geom_density(fill = \"#76B7B2\", color=\"black\", alpha = 0.2) +\n  geom_vline(aes(xintercept=mean(dif_thickness)),\n            color=\"blue\", linetype=\"dashed\", size=1.2) +\n  geom_vline(aes(xintercept=median(dif_thickness)),\n            color=\"red\", linetype=\"dashed\", size=1.2) +\n  labs(x = \"Differences of thickness (micron)\") +\n  theme_minimal() +\n  theme(plot.title.position = \"plot\")\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\n\nSummary statistics\nSummary statistics can also be calculated for the variables.\n\n\n\n\n\n\nSummary statistics\n\n\n\n\n\ndplyr\ndlookr\n\n\n\nWe can utilize the across() function to obtain the results across the three variables simultaneously:\n\nsummary_eyes <- eyes %>%\n  dplyr::summarise(across(\n    .cols = c(dif_thickness, affected_eye, unaffected_eye), \n    .fns = list(\n    N = ~n(),\n    Min = min,\n    Q1 = ~quantile(., 0.25),\n    median = median,\n    Q3 = ~quantile(., 0.75),\n    Max = max,\n    Mean = mean,\n    Sd = sd,\n    Skewness = EnvStats::skewness,\n    Kurtosis= EnvStats::kurtosis\n    ), na.rm = TRUE,\n    .names = \"{col}_{fn}\")\n    )\n\n# present the results\nsummary_eyes <- summary_eyes %>% \n  mutate(across(everything(), round, 2)) %>%   # round to 3 decimal places\n  pivot_longer(1:30, names_to = \"Stats\", values_to = \"Values\")  # long format\n\nsummary_eyes\n\n# A tibble: 30 × 2\n   Stats                  Values\n   <chr>                   <dbl>\n 1 dif_thickness_N          8   \n 2 dif_thickness_Min      -18   \n 3 dif_thickness_Q1       -13   \n 4 dif_thickness_median    -3   \n 5 dif_thickness_Q3         4   \n 6 dif_thickness_Max       12   \n 7 dif_thickness_Mean      -4   \n 8 dif_thickness_Sd        10.7 \n 9 dif_thickness_Skewness   0.03\n10 dif_thickness_Kurtosis  -1.37\n# … with 20 more rows\n\n\n\n\n\neyes %>% \n  dlookr::describe(dif_thickness, affected_eye, unaffected_eye) %>% \n  select(described_variables, n, mean, sd, p25, p50, p75, skewness, kurtosis) %>% \n  ungroup()\n\n# A tibble: 3 × 9\n  described_variables     n  mean    sd   p25   p50   p75 skewness kurtosis\n  <chr>               <int> <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl>\n1 dif_thickness           8    -4  10.7  -13     -3    4    0.0295   -1.37 \n2 affected_eye            8   455  27.7  436.   459  478.  -0.493    -0.985\n3 unaffected_eye          8   459  31.3  442    470  480.  -1.11      0.794\n\n\n\n\n\n\n\nThe differences seems to come from a population with a symmetrical distribution and the skewness is close to zero (0.03). However, the (excess) kurtosis equals to -1.37 (platykurtic) and the sample size is small. Therefore, the data may not follow the normal distribution.\nNormality test We can use Shapiro-Wilk test to check for normality of the differences. However, here, normality test is not helpful because of the small sample (the test is under-powered).\n\n eyes %>%\n    shapiro_test(dif_thickness)\n\n# A tibble: 1 × 3\n  variable      statistic     p\n  <chr>             <dbl> <dbl>\n1 dif_thickness     0.944 0.651\n\n\nThe Shapiro-Wilk test suggests that the weight differences are normally distributed (p=0.65 > 0.05)."
  },
  {
    "objectID": "wilcoxon_test.html#run-the-wilcoxon-signed-rank-test",
    "href": "wilcoxon_test.html#run-the-wilcoxon-signed-rank-test",
    "title": "4  Wilcoxon Signed-Rank test",
    "section": "\n4.5 Run the Wilcoxon Signed-Rank test",
    "text": "4.5 Run the Wilcoxon Signed-Rank test\nThe differences between the two measurements can be tested using a rank test such as Wilcoxon Signed-Rank test.\n\n\n\n\n\n\nWilcoxon Signed-Rank test\n\n\n\n\n\nBase R (1st way)\nBase R (2nd way)\nrstatix\n\n\n\n\nwilcox.test(eyes$dif_thickness)\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  eyes$dif_thickness\nV = 7.5, p-value = 0.3088\nalternative hypothesis: true location is not equal to 0\n\n\n\n\n\nwilcox.test(eyes$affected_eye, eyes$unaffected_eye, paired = TRUE)\n\n\n    Wilcoxon signed rank test with continuity correction\n\ndata:  eyes$affected_eye and eyes$unaffected_eye\nV = 7.5, p-value = 0.3088\nalternative hypothesis: true location shift is not equal to 0\n\n\n\n\n\n eyes %>%\n     wilcox_test(dif_thickness ~ 1)\n\n# A tibble: 1 × 6\n  .y.           group1 group2         n statistic     p\n* <chr>         <chr>  <chr>      <int>     <dbl> <dbl>\n1 dif_thickness 1      null model     8       7.5 0.309\n\n\n\n\n\n\n\nThe result is not significant (p = 0.31 > 0.05). However, we can’t be certain that there is not difference in corneal thickness in affected and unaffected eyes because the sample size is very small."
  },
  {
    "objectID": "wilcoxon_test.html#present-the-results-in-a-summary-table",
    "href": "wilcoxon_test.html#present-the-results-in-a-summary-table",
    "title": "4  Wilcoxon Signed-Rank test",
    "section": "\n4.6 Present the results in a summary table",
    "text": "4.6 Present the results in a summary table\n\nShow the codetb2 <- eyes %>%\n  select(-dif_thickness) %>% \n  pivot_longer(!id, names_to = \"groups\", values_to = \"thickness\")\n\ngt_sum4 <- tb2 %>% \ntbl_summary(by = groups, include = -id,\n            label = list(thickness ~ \"thickness (microns)\"),\n            digits = list(everything() ~ 1)) %>%\n  add_p(test = thickness ~ \"paired.wilcox.test\", group = id) %>% \n  as_gt()\n  \ngt_sum4 \n\n\n\n\n\n\nCharacteristic\n      \naffected_eye, N = 81\n\n      \nunaffected_eye, N = 81\n\n      \np-value2\n\n    \n\nthickness (microns)\n459.0 (436.5, 478.5)\n470.0 (442.0, 479.5)\n0.3\n\n\n\n\n1 Median (IQR)\n    \n\n\n2 Wilcoxon signed rank test with continuity correction\n    \n\n\n\n\n\nThere is not evidence from this small study with patients of glaucoma that the thickness of the cornea in affected eyes, median = 459 \\(\\mu{m}\\) (IQR: 436.5, 478.5) \\(\\mu{m}\\), differs from unaffected eyes 470 \\(\\mu{m}\\) (442, 479.5) (p=0.30 >0.05)."
  }
]